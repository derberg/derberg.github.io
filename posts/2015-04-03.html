<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Learn the configuration and understand its possibilities">
    <meta name="author" content="0">


    <title>exTW Blog</title>

    <!-- Using DocPad built in helper to collect all the styles listed in configuration file and render a HTML markup for them -->
    <link  rel="stylesheet" href="/css/bootstrap.min.css" /><link  rel="stylesheet" href="/css/clean-blog.min.css" />

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <script>(function(i,s,o,g,r,a,m)            {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();            a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;            a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script',            '//www.google-analytics.com/analytics.js','ga');            ga('create', 'UA-62858836-1', 'auto');            ga('send', 'pageview');</script>
    <script type='text/javascript' id='inspectletjs'>            window.__insp = window.__insp || [];            __insp.push(['wid', 1668565138]);            (function() {            function __ldinsp(){var insp = document.createElement('script');            insp.type = 'text/javascript'; insp.async = true;            insp.id = 'inspsync';            insp.src = ('https:'            == document.location.protocol ? 'https' : 'http')            + '://cdn.inspectlet.com/inspectlet.js';            var x = document.getElementsByTagName('script')[0];            x.parentNode.insertBefore(insp, x); }            if (window.attachEvent) window.attachEvent('onload', __ldinsp);            else window.addEventListener('load', __ldinsp, false);            })();            </script>
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/index.html">Home</a>
                    </li>
                    <li>
                        <a href="/about.html">About</a>
                    </li>
                    <!--<li>
                        <a href="/posts/index.html">Posts</a>
                    </li>-->
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Content of any document that uses this layout is placed here, document by document during DocPad generation process  -->
    <!-- Page Header -->
<!-- Set your background image for this header on the line below. -->
<header class="intro-header" style="background-image: url('/img/post-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>DocPad Configuration</h1>
                    <h2 class="subheading">Learn the configuration and understand its possibilities</h2>
                    <span class="meta">Posted by <a href="#">Lukasz Gornicki</a> on April 3, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- Content of any document that uses this layout is placed here, document by document during DocPad generation process  -->
                <p>Before I jump to the main topic of this post I have to share with you my recent discoveries. Over last couple of days I played a bit with NodeJS and AngularJS. This post is not about them so I will just paste awesome learning resources here, for a reference:</p>
<ul>
<li>NodeJS: <a href="http://nodeschool.io/">http://nodeschool.io/</a></li>
<li>AngularJS: <a href="http://campus.codeschool.com/courses/shaping-up-with-angular-js">http://campus.codeschool.com/courses/shaping-up-with-angular-js</a></li>
</ul>
<p>Now back to business. After reading my recent <a href="2015-02-21.html">post</a> you are familiar with DocPad&#39;s project structure. Now let us dig into the topic of DocPad configuration. Once you learn what you can configure, you&#39;ll understand how powerful the DocPad is.</p>
<h2 id="format">Format</h2>
<p>It must be a file with <code>docpad</code> basename. Good news for experienced JavaScripters: if you don&#39;t like CoffeeScript, you can write configuration with JavaScript. It means your configuration file can either be <code>docpad.coffee</code> or <code>docpad.js</code>. It is also possible to have <code>docpad.json</code> or <code>docpad.cson</code> but it doesn&#39;t make sense as you will not be able to pass any functions there, so it kind of sucks.</p>
<p>So yeah, JavaScript or CoffeeScript format. That means you can put anything there. You can define any function  and later on reuse in your templating.</p>
<h2 id="structure">Structure</h2>
<p>DocPad is a NodeJS application, right? So its configuration is just a simple module. What does that mean? It must provide an object with a certain name - in this case <code>docpadConfig</code>. It is of course an object, that contains not only some values, but also functions.
There are several main attributes of the config file. I will explain in details those that we use in this blog, and mention rest for the reference.</p>
<h3 id="templatedata">templateData</h3>
<p>The name explains exactly what it is. Whatever you define here, will be accessible for your templates. You can define here some variables with values and even some helper methods.</p>
<p>Looking on this blog project, there is one simple helper that should explain what is this all for:</p>
<pre><code>getCuttedContent: (content) -&gt;
  content.substr(0, 250);
</code></pre><p>Super simple function to cut out first 250 characters from a given string. In this blog I use this helper for generation of the blog landing page. I can list not only title, description and creator of the blog there, but also an abstract of the content.</p>
<p>My blog landing page is an <code>index.html.eco</code> and this is a part of it that uses <strong>getCuttedContent</strong> helper method. It is so called <strong>template</strong> that I mention so often - in below sample I&#39;m templating HTML to get a specific paragraph rendered:</p>
<pre><code>&lt;p&gt;
  &lt;% if post.contentRenderedWithoutLayouts isnt null :%&gt;
    &lt;%- @getCuttedContent(post.contentRenderedWithoutLayouts) %&gt;
  &lt;% end %&gt;
&lt;/p&gt;
</code></pre><p>So if the post object&#39;s metadata with content that is already rendered is not null, it is being substringed and returned - simple as that.</p>
<p>As if it comes to the <strong>metadata</strong> mentioned above. If you are not familiar with this topic yet, please go back to one of my posts: <a href="/posts/2015-02-21.html#document-s-metadata">DocPad Architecture - Basics</a></p>
<h3 id="collections">collections</h3>
<p>Here you define the collections of documents that are available for your templating. <code>Documents</code> doesn&#39;t mean only documents. <code>Document</code> is normally a name of the record in any document NoSQL database - I guess that mainly because these databases (like MongoDB) store data as JSON files. DocPad uses super powerful QueryEngine to query over DocPad objects, its syntax is a copy of MongoDB syntax. This equation is pretty simple I guess.</p>
<p>Therefor in other words, anything that is in the <code>documents</code> folder (therefor processed by DocPad) is considered to be a document, even scripts or stylesheets. This is super handy as you can use helpers (mentioned in section above) in scripts as well.</p>
<h4 id="defining-collection">Defining collection</h4>
<p>Now, it all means that you have to define a proper collection with specific query to get exactly what you need.</p>
<p>Let me try to explain with sample again. Below you can see a collection defined for this blog to list all the posts:</p>
<pre><code>posts: -&gt;
  @getCollection(&quot;html&quot;)
    .findAllLive(
      {basename:{$ne: &quot;index&quot;},
      relativeOutDirPath:&quot;posts&quot;,
      title:{$exists:true}},
      [filename:-1])
</code></pre><p>DocPad has a number of built in collections, and one of them is <strong>html</strong>. So the first thing I do above is I add to my collection all the files that after processing would end up as HTML files. For more information about build in collections read <a href="https://docpad.org/docs/template-data">https://docpad.org/docs/template-data</a>. Then I&#39;m passing two things:</p>
<ul>
<li>Setting a query to:<ul>
<li>Eliminate <strong>index</strong> files</li>
<li>Taking only files that after rendering would end up in <strong>out/posts</strong> directory</li>
<li>Collecting only files that have <strong>title</strong> metadata defined</li>
</ul>
</li>
<li>Ordering the whole collection with the file name, descending.</li>
</ul>
<p>Looking at above query you should get an understanding of how powerful querying is:</p>
<ul>
<li>You can query over any object&#39;s metadata - build in (<strong>basename</strong>, <strong>relativeOutDirPath</strong>) or defined by you (<strong>title</strong>)</li>
<li>Query syntax is super powerful: <a href="https://learn.bevry.me/queryengine/guide">https://learn.bevry.me/queryengine/guide</a></li>
</ul>
<p></p>

<h4 id="using-collection">Using collection</h4>
<p>This is how by using collection called <strong>posts</strong> I&#39;m building a list of all posts on this blog <a href="/index.html">landing page</a>:</p>
<pre><code>&lt;% for post in @getCollection(&quot;posts&quot;).findAll().toJSON(): %&gt;
  &lt;div class=&quot;post-preview&quot;&gt;
      &lt;a href=&quot;&lt;%- post.url %&gt;&quot;&gt;
          &lt;h2 class=&quot;post-title&quot;&gt;
              &lt;%- post.title %&gt;
          &lt;/h2&gt;
          &lt;h3 class=&quot;post-subtitle&quot;&gt;
              &lt;%- post.description %&gt;
          &lt;/h3&gt;
      &lt;/a&gt;
      &lt;p&gt;
        &lt;% if post.contentRenderedWithoutLayouts isnt null :%&gt;
          &lt;%- @getCuttedContent(post.contentRenderedWithoutLayouts) %&gt;
        &lt;% end %&gt;
      &lt;/p&gt;
      &lt;p class=&quot;post-meta&quot;&gt;Posted by &lt;a href=&quot;/about.html&quot;&gt;&lt;%- post.author %&gt;&lt;/a&gt; on &lt;%- post.day %&gt;&lt;/p&gt;
  &lt;/div&gt;
  &lt;hr&gt;
&lt;% end %&gt;
</code></pre><p>With a <strong>for</strong> loop I&#39;m iterating over a collection of all posts, described in a previous section. Each DocPad object is referred as a <strong>post</strong> variable. To access any part of the object I parse it <code>toJSON()</code> and then access, with dot notation each of its attributes:</p>
<ul>
<li><code>post.url</code> to access the built-in attribute/metadata that holds a link to the post</li>
<li><code>post.contentRenderedWithoutLayouts</code> to access the built-in attribute/metadata that holds post&#39;s content already rendered into HTML but without layouts usage.</li>
<li><code>pots.title</code>, <code>post.description</code>, <code>post.author</code>, <code>post.day</code> to access attributes/metadatas I&#39;ve added manually to each post.</li>
</ul>
<p>To conclude: <strong>div</strong> element with <strong>class=&quot;post-preview&quot;</strong> will be rendered on a page for each post in the <strong>posts</strong> collection. There is also a part about cutting the post&#39;s content, which I&#39;ve already described in a section about template data.</p>
<h3 id="plugins">plugins</h3>
<p>Here you configure plugins that you are using. So you just pass an object with configuration attributes that are accepted by the plugin. Best samples are real samples, so just take a look on the <strong>ghpages</strong> plugin that I&#39;m using for my blog:</p>
<pre><code>plugins:
  ghpages:
    deployRemote: &#39;target&#39;
    deployBranch: &#39;master&#39;
</code></pre><p>This means that I&#39;m deploying my rendered content to the master branch of a repository I&#39;m initially configured as a target.</p>
<h3 id="events">events</h3>
<p>Currently not used in this blog project. You can use this section to extend DocPad&#39;s functionality by hooking into the generation process. DocPad emits a number of different events. In other words, there is an event that indicates that generation is about to start, and you can add your logic there that will influence the generation. Real sample are the plugins used in this project, <code>marked</code> and <code>eco</code>. Both of them are hooking into the generation process when <code>render</code> event is emitted, so they influence rendering of files. <code>Marked</code> plugin acts on files with <code>md</code> or <code>markdown</code> extensions and <code>eco</code> on files with <code>eco</code> extension.</p>
<h3 id="environments">environments</h3>
<p>This is useful for more advanced projects when you have to generate your project for different environments. You can define here as many environments as you want, and in each of those create completely different configuration.</p>
<p><hr>
I hope that explanation was clear enough. Shoot me any questions if you still don&#39;t get it entirely. The good thing is that we are pretty much done with a basic theory and with next posts we can jump into more practical topics, like enabling RSS or commenting.</p>

                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES * * */
                    var disqus_shortname = 'extwblog';

                    /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
    </div>
</article>
<hr>


    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="https://twitter.com/derberq">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="http://stackoverflow.com/users/2088167/lukasz-gornicki">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/derberg">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <div class='foot'>
                      <center>
                        I'm using Google Analytics and Inspectlet to track </br>behaviour of my readers to learn how they interact with my blog.
                      </center>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Using DocPad built in helper to collect all the scripts listed in configuration file and render a HTML markup for them -->
    <script defer="defer"  src="/js/jquery.min.js"></script><script defer="defer"  src="/js/bootstrap.min.js"></script><script defer="defer"  src="/js/clean-blog.min.js"></script>

</body>

</html>
